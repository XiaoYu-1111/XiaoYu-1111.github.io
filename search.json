[{"title":"基于GPU Computer Shader波场模拟技术文档","url":"/2026/01/21/GPU%E6%B3%A2%E5%9C%BA%E6%A8%A1%E6%8B%9F%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/","content":"HPEW-Sim v3.0: High-Performance Elastic Wave Simulator高性能二维弹性波动力学模拟与可视化平台\n\n1. 系统概述 (System Overview)HPEW-Sim v3.0 是一款专为地球物理勘探、地震学研究及波动物理教学打造的下一代数值模拟平台。它采用 GPU 原生并行架构，突破了传统 CPU 串行计算的性能瓶颈，实现了百万级网格规模下的实时弹性波场模拟。\n1.1 核心价值 (Core Value)\n科研级精度: 空间 8 阶 / 时间 2 阶交错网格有限差分格式（FDTD），将数值频散降至理论极限。\n交互式建模: 所见即所得的地质模型编辑系统，支持实时修改介质属性（$V_p, V_s, \\rho$）。\n工业级采集: 内置高精度合成地震记录系统，支持大规模阵列数据采集与导出。\n艺术化呈现: 独创“梵高星空”流体渲染技术，将枯燥的物理数据转化为极具美感的视觉艺术。\n\n1.2 关键特性清单 (Feature List)\n\n\n\n模块\n功能亮点\n\n\n\n\n计算内核\nOpenGL 4.3 Compute Shader, 单帧并行处理 &gt;1M 节点, 零拷贝渲染架构。\n\n\n物理引擎\n完整弹性波方程 (P+S波), CPML 吸收边界, 自由表面 (Free Surface), 刚性反射边界。\n\n\n震源系统\n单点脉冲, 线震源, 随机微震源, 旋转定向力源 (Tensor Rotation)。\n\n\n可视化\n速度/应力场切换, P/S 波场分离, 实时频谱分析 (FFT), 多种科学/艺术色谱。\n\n\n数据 I/O\n模型导入/导出, 地震数据 CSV 导出, 4K 序列帧录制, 实时截图。\n\n\n稳定性\n硬件级数值溢出检测 (Explosion Detection), 自动熔断与参数修正。\n\n\n\n\n\n2. 物理与数学原理 (Physics &amp; Mathematics)本系统求解的是二维非均匀、各向同性介质中的一阶速度-应力弹性波方程（Velocity-Stress Elastic Wave Equation）。\n2.1 控制方程 (Governing Equations)在二维笛卡尔坐标系 $(x, z)$ 下（对应软件中的 x 和 y，向下为正），方程组由牛顿第二定律（运动方程）和广义胡克定律（本构方程）组成：\nA. 运动方程 (Momentum Equations):描述质点加速度与应力梯度的关系：\n\\rho \\frac{\\partial v_x}{\\partial t} = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xz}}{\\partial z} + f_x\\rho \\frac{\\partial v_z}{\\partial t} = \\frac{\\partial \\sigma_{xz}}{\\partial x} + \\frac{\\partial \\sigma_{zz}}{\\partial z} + f_zB. 本构方程 (Constitutive Equations):描述应力变化率与应变率（速度梯度）的关系：\n\\frac{\\partial \\sigma_{xx}}{\\partial t} = (\\lambda + 2\\mu)\\frac{\\partial v_x}{\\partial x} + \\lambda\\frac{\\partial v_z}{\\partial z}\\frac{\\partial \\sigma_{zz}}{\\partial t} = \\lambda\\frac{\\partial v_x}{\\partial x} + (\\lambda + 2\\mu)\\frac{\\partial v_z}{\\partial z}\\frac{\\partial \\sigma_{xz}}{\\partial t} = \\mu (\\frac{\\partial v_x}{\\partial z} + \\frac{\\partial v_z}{\\partial x})参数定义:\n\n$v_x, v_z$: 质点振动速度矢量 (Velocity Vector)。\n$\\sigma{xx}, \\sigma{zz}$: 正应力分量 (Normal Stress)。\n$\\sigma_{xz}$: 剪切应力分量 (Shear Stress)。\n$\\rho$: 介质密度。\n$\\lambda, \\mu$: 拉梅常数 (Lamé parameters)，由纵波速度 $V_p$ 和横波速度 $V_s$ 导出：\n$\\mu = \\rho V_s^2$\n$\\lambda = \\rho V_p^2 - 2\\mu$\n\n\n\n2.2 高阶数值离散 (Numerical Scheme)为了在有限算力下获得最高精度，系统采用了 交错网格 (Staggered Grid) 技术。\n\n网格布局:\n\n速度分量 $(vx, v_z)$ 与应力分量 $(\\sigma{ij})$ 在空间上交错半个网格步长分布。\n这种布局天然满足中心差分格式，具有更高的数值稳定性，且能自然处理泊松比差异大的介质界面。\n\n\n空间 8 阶精度 (8th-Order Spatial Accuracy):\n\n在计算空间导数时，利用目标点周围 8 个 网格点的信息进行加权求和。\n差分算子: $\\frac{\\partial f}{\\partial x} \\approx \\frac{1}{\\Delta x} \\sum_{n=1}^{4} C_n [f(x + \\frac{2n-1}{2}\\Delta x) - f(x - \\frac{2n-1}{2}\\Delta x)]$\n系数: $C_1 \\approx 1.19629, C_2 \\approx -0.07975, C_3 \\approx 0.00957, C_4 \\approx -0.00069$。\n优势: 相比传统的 2 阶或 4 阶精度，8 阶精度能显著抑制数值频散 (Numerical Dispersion)，使得波在长距离传播后依然保持清晰的波形，不发生畸变。\n\n\n时间 2 阶精度 (Leapfrog Integration):\n\n采用时间交错更新策略：$t$ 时刻更新速度 $\\rightarrow$ $t+0.5$ 时刻更新应力 $\\rightarrow$ $t+1$ 时刻更新速度。\n\n\n\n2.3 边界条件 (Boundary Conditions)\nCPML / Cerjan 吸收边界 (Absorb):\n在模拟区域四周设置具有指数衰减特性的海绵层（Sponge Layer）。\n作用: 模拟无限大的地下空间，防止波传到网格边缘时产生非物理的人工反射。\n\n\n自由表面 (Free Surface):\n物理含义: 模拟地表与空气的交界处（空气无法对地面施加应力）。\n实现: 通过镜像法强制上边界处的法向应力为零 ($\\sigma{zz}=0, \\sigma{xz}=0$)。\n意义: 这是产生高能量 瑞利面波 (Rayleigh Wave) 的必要条件，也是很多简易模拟器所缺失的高级功能。\n\n\n\n\n3. 用户操作手册 (User Manual)3.1 界面概览 (Interface Layout)界面遵循现代 macOS Dark 风格，分为三大功能区：\n\n左侧控制面板 (Control Panel): 包含所有模拟参数、工具切换、数据采集设置。\n中央视口 (Viewport): 实时渲染波场，支持鼠标交互。\n右上角状态浮窗 (Overlay): 实时显示 FPS、模拟时间、鼠标位置的物理参数 ($V_p, V_s, \\rho$)。\n\n3.2 快捷键速查 (Shortcuts)\n\n\n\n按键\n功能\n详细描述\n\n\n\n\nSpace\n暂停 / 继续\n冻结或恢复模拟时钟，方便观察波场细节。\n\n\nC\n清除波场\n仅清空当前的波场数值，保留地质模型结构。\n\n\nBackspace\n完全重置\n危险操作。清空波场并重置为默认的均匀介质模型。\n\n\nP\n截图\n保存当前视口画面为 PNG 图片（不含 UI）。\n\n\n↑ / ↓\n增益调节\n增加/减小波场显示的亮度系数 (Scale)，用于观察弱信号。\n\n\nQ\n切换波场样式\n循环切换 Magma / Van Gogh / Coolwarm 等渲染风格。\n\n\nW\n切换模型样式\n循环切换地质背景的显示风格（如地质填图、灰度密度等）。\n\n\nEsc\n返回欢迎页\n暂停模拟并返回启动界面（低功耗模式）。\n\n\n\n\n3.3 工具模式 (Tool Modes - 数字键 1-8)\n\n\n\n键位\n工具名称\n鼠标左键操作\n\n\n\n\n1\nSource (震源)\n点击放置单点震源 (Ricker Wavelet)。\n\n\n2\nHigh Speed\n绘制高速介质（如基岩、花岗岩）。\n\n\n3\nLow Speed\n绘制低速介质（如水体、疏松沉积物）。\n\n\n4\nWall\n绘制刚性反射壁（极高密度障碍物）。\n\n\n5\nEraser\n橡皮擦，恢复为背景介质。\n\n\n6\nArray Tool\n检波器阵列工具（主要配合右键拖拽使用）。\n\n\n7\nRect Fill\n矩形填充：拖拽框选，松手后用指定参数填充该区域。\n\n\n8\nRect Select\n矩形选择：仅画框，不修改模型（用于为随机震源指定区域）。\n\n\n\n\n\n4. 功能模块详解 (Feature Modules)A. Simulation (模拟核心设置)\nCore Control: \nRUNNING/PAUSED: 状态切换。\nRESET TIME: 仅将时间 $t$ 重置为 0，保留波场。\n\n\nPhysics Parameters:\nTime Step (dt): 时间步长。重要：8阶精度对 dt 敏感，若发生爆炸请减小此值。\nGrid Spacing (dx): 空间步长（米/像素）。\n\n\nGrid Size:\nWidth/Height: 设置网格分辨率。\nAPPLY SIZE: 应用新尺寸并销毁当前模型。\n\n\nBoundary Conditions:\n快捷按钮：All Absorb (全吸收), All Reflect (全反射), Free Top (地表模式)。\nPML Layer: 设置吸收层的厚度及是否显示辅助网格。\n\n\nAccelerate: 勾选后关闭垂直同步和画面渲染，让 GPU 全速跑物理计算（适合长时数据录制）。\n\nB. Data Export (数据采集系统 - 核心)用于生成合成地震记录（Seismogram）。\n\nAcquisition Settings:\nSampling Rate: 采样率（如 1000Hz = 0.001s 记一次）。\nRecord Duration: 录制总时长（秒）。\nTarget Samples: 系统自动计算预计生成的总点数。\n\n\nReceiver Geometry (检波器):\nChannels: 检波器道数。\nX Range: 首道和尾道的横向坐标。\nDepth: 检波器埋深。\nDEPLOY LINEAR ARRAY: 点击后在画面生成蓝色倒三角图标。\n\n\nRecording Control:\nSTART CAPTURE: 仅开始录制数据（不重置波场，用于接续录制）。\nTRIGGER &amp; ACQUIRE (红色按钮): 一键自动化操作。\n清空当前所有波场。\n在 Single Shot 设定的位置激发一炮。\n同步开始录制数据。\n达到时长后自动停止并保存 CSV。\n\n\n\n\n\nC. Random Source (随机震源/微震)用于模拟微震活动或声发射实验。\n\n切换到工具 8 (Rect Select)，在画面中框选一个区域（如断层带）。\n点击面板上的 Snap to Rect Selection 读取坐标。\n设置 Total Shots（总次数）、Duration（持续时间）及频率/振幅范围。\n点击 Start Generation，系统将在该区域内随机时空激发震源。\n\nD. Visualization (可视化)\nVis Mode: \nVelocity Mag: 速度能量。\nP-Wave (Div): 仅显示纵波（散度场）。\nS-Wave (Curl): 仅显示横波（旋度场）。\n\n\nWave Style: \nMagma: 能量热力图。\nVan Gogh: 结合流线与厚涂质感的艺术风格（显示波前方向）。\nCoolwarm: 标准科学红蓝配色。\n\n\nLegend: 底部集成的色标，实时显示颜色对应的数值含义。\n\n\n5. 典型工作流 (Workflows)场景 A：合成地震记录生成 (Seismic Data Acquisition)目标: 模拟一次地表主动源勘探，获取炮集记录。\n\n建模: 使用矩形工具绘制地层结构，边界设为 Free Top。\n设置: 在 Single Shot 面板设置激发点坐标（如 X=500, Y=10）。\n布设: 在 Data Export 面板设置 100 道检波器，点击部署。\n采集: 设置时长 1.5s，点击 TRIGGER &amp; ACQUIRE。\n结果: 等待进度条结束，在程序目录查看生成的 seismic_final.csv。\n\n场景 B：复杂介质波场传播教学目标: 演示波在非均匀介质中的反射、透射和绕射。\n\n环境: 选择 Van Gogh 风格，增益调至 50.0。\n操作: 使用 Wall 工具绘制障碍物（如空洞、隧道）。\n激发: 使用 Source 工具点击障碍物上方。\n观察: 实时观察波前的反射、绕射及沿地表传播的瑞利波。\n分析: 切换 Vis Mode 到 P-Wave 或 S-Wave，观察波场分离现象。\n\n\n6. 故障排除 (Troubleshooting)\n\n\n\n问题现象\n可能原因\n解决方案\n\n\n\n\n屏幕突然变白 / 提示 EXPLODED\n数值爆炸 (CFL条件破坏)。\n1. 减小 Time Step (dt)。2. 点击报警弹窗中的 Auto-Fix。3. 检查是否画了极高速度(&gt;8000)的异常介质。\n\n\n震源位置与鼠标点击不重合\n坐标系 Y 轴未翻转。\n软件内部已处理（UI左上角为0，物理左下角为0）。请确认未修改核心坐标转换代码。\n\n\n导出的数据点数不足 (如1.0s断开)\n自动停止逻辑冲突。\n请务必使用 Data Export 面板的 TRIGGER &amp; ACQUIRE 按钮，它会自动接管并协调停止逻辑。\n\n\n中文显示乱码\n编码问题。\n确保源码文件保存为 UTF-8 with BOM 格式，并正确加载了中文字体文件。\n\n\n模拟速度慢\n渲染开销过大。\n在进行长时录制时，勾选 Accelerate 复选框，关闭画面渲染以加速计算。\n\n\n\n\n\n7. 应用前景 (Applications)\n石油与天然气勘探:\n正演模拟 (Forward Modeling)：验证地质解释模型，辅助观测系统设计。\n全波形反演 (FWI)：生成海量带标签的合成地震数据，用于算法测试或 AI 训练。\n\n\n地震学研究:\n地壳深部结构成像。\n瑞利面波（Rayleigh Wave）频散特性研究。\n\n\n工程与无损检测:\n混凝土/金属构件超声波检测仿真。\n隧道超前预报模拟。\n\n\n数据驱动的 AI 训练:\n快速批量生成地震数据，用于去噪、插值或反演网络的训练。\n\n\n科学教育与艺术:\n波动方程可视化教学。\n生成具有物理美感的流体艺术动画。\n\n\n\n","tags":["Wave Simulator","GPU","Computer Shader"]},{"title":"SeisMonitor实时地震台站监测系统技术文档","url":"/2026/01/21/SeisMonitor%E5%AE%9E%E6%97%B6%E5%9C%B0%E9%9C%87%E5%8F%B0%E7%AB%99%E7%9B%91%E6%B5%8B%E7%B3%BB%E7%BB%9F%E6%8A%80%E6%9C%AF%E6%96%87%E6%A1%A3/","content":"SeisMonitor - 实时地震台站监测系统技术文档1. 产品概述 (Product Overview)SeisMonitor 是一款基于 Qt 6 (C++) 和 OpenGL 技术构建的专业级地球物理数据监测终端。该软件专为地震学研究人员、台网监测人员及地球科学爱好者设计，支持通过国际通用的 SeedLink 协议 实时接入全球地震台网（如 GEOFON, IRIS 等），提供毫秒级延迟的波形显示、实时信号处理、时频分析及全球台站地理信息可视化功能。\n2. 软件特点与核心优势 (Key Features &amp; Advantages)2.1 高性能实时渲染\n极速绘图引擎：基于深度优化的 QCustomPlot 和 QML 技术，支持在大数据量下流畅显示三分量（Z/N/E）波形及高分辨率瀑布图。\n低延迟架构：采用异步 TCP Socket 通信与双缓冲机制，确保数据包到达与屏幕刷新之间的延迟降至最低。\n海量地图标记：利用 QML Instantiator 与纹理优化技术，实现在地图上流畅渲染 17,000+ 个台站节点，支持毫秒级交互响应。\n\n2.2 专业级信号处理 (DSP Pipeline)\n实时滤波管道：内置 IIR 巴特沃斯滤波器（低通、高通、带通），支持用户动态调整截止频率，实时去除背景噪声。\n基线校正：支持实时 去均值 (Demean)，自动消除仪器零漂，确保波形居中显示。\n时频分析：集成实时 短时傅里叶变换 (STFT)，以瀑布图（Spectrogram）形式直观展示频率能量随时间的变化，辅助识别干扰信号（如 50Hz 工频干扰）。\n\n2.3 智能事件检测 (Smart Detection)\nSTA/LTA 触发算法：内置经典的短时/长时平均比法自动检测算法。\n可视化报警：当地震发生时，波形图自动绘制 红色触发线 (ON) 和 绿色结束线 (OFF)，并在状态栏显示警报。\n参数可调：支持用户针对不同环境噪声水平，实时调整 STA/LTA 窗口长度及触发阈值。\n\n2.4 现代交互体验 (Modern UX)\nDock 布局系统：采用 Visual Studio 风格的可停靠窗口设计，用户可自由拖拽、重组波形图、地图、控制台和设置面板，支持多屏工作。\n深色/浅色主题：内置专业的“科研白”与“暗黑监测”模式，适应白天办公与夜间值守场景，图表配色（如 Viridis, Turbo, Seismic）符合科学可视化标准。\n多维联动：\n光标同步：在波形图上移动鼠标，Z/N/E 分量及瀑布图的光标线精准同步，便于对比相位。\n图地联动：点击地图台站 -&gt; 自动切换数据流；切换数据流 -&gt; 地图自动高亮定位。\n\n\n\n\n3. 功能模块详解 (Functional Modules)3.1 数据连接与管理 (Connection Manager)\n多服务器预设：内置 GEOFON (德国)、IRIS (美国)、RESIF (欧洲) 等主流数据中心地址，支持一键切换。\nFDSN 元数据同步：后台自动下载最新的台站经纬度信息，构建本地台站数据库。\n智能列表：自动获取当前服务器可用的实时流列表，支持通过下拉框快速检索。\n\n3.2 实时波形视图 (Waveform Viewer)\n三分量显示：独立显示垂直 (Z)、北向 (N)、东向 (E) 分量，支持独立或同步缩放。\n自适应量程：支持 Auto-Scale（根据振幅自动调整 Y 轴）和手动指定量程（如 ±2000 Counts）。\n交互操作：\n平移/缩放：鼠标拖拽平移，滚轮缩放时间轴。\n数据框选：按住 Shift 键框选特定波形段进行高亮分析。\n通道控制：可通过底部复选框快速隐藏/显示特定分量。\n\n\n\n3.3 全球台站地图 (GIS Module)\n混合地图源：集成高德地图（AutoNavi），支持 标准矢量图 和 卫星影像图 一键切换。\n坐标纠偏：内置 WGS-84 到 GCJ-02 转换算法，确保中国境内台站位置与高德底图精准重合。\n状态可视化：\n🔴 红色三角形：离线台站（元数据存在，但无实时流）。\n🟢 绿色三角形：在线台站（服务器当前可用）。\n🟡 黄色三角形：当前正在监测的台站。\n🔵 青色高亮：鼠标选中的台站。\n\n\n性能优化：支持图层过滤（显示/隐藏离线台站），极大提升渲染性能。\n\n3.4 数据录制与日志 (Recording &amp; Logging)\nMini-SEED 录制：支持将接收到的原始二进制数据包直接保存为标准的 .mseed 文件，兼容 ObsPy、SAC 等专业软件。\n系统控制台：底部集成日志输出窗口，实时记录连接状态、数据包到达时间、采样率变更及触发事件，支持日志导出。\n\n\n4. 技术架构 (Technical Architecture)\n\n\n\n组件\n技术选型\n说明\n\n\n\n\n开发框架\nQt 6.6.3 (C++)\n跨平台 GUI 框架，利用信号槽机制实现模块解耦。\n\n\n网络协议\nTCP / HTTP\nQTcpSocket 实现 SeedLink 协议；QNetworkAccessManager 实现 FDSN REST API 请求。\n\n\n数据解析\nlibmseed v3\n行业标准库，用于解析 Mini-SEED 格式及 Steim-2 压缩数据。\n\n\n绘图引擎\nQCustomPlot 2.1\n定制化的高性能 2D 绘图库，支持 GPU 加速和图层管理。\n\n\n地图引擎\nQt Location / QML\n利用 OpenGL 硬件加速渲染地图瓦片和海量标记点。\n\n\n数据结构\n哈希表 (QHash)\n优化台站查找算法，将地图交互的时间复杂度从 O(N) 降至 O(1)。\n\n\n\n\n\n5. 快速操作指南 (Quick Start)\n启动连接：\n在顶部工具栏选择服务器（如 “GEOFON”）。\n点击 “Get Stations” 获取可用台站列表。\n在下拉框中选择一个台站（或在地图上点击绿色三角形）。\n点击 “Start Stream” 开始接收数据。\n\n\n调整视图：\n使用底部 “View Settings” 面板切换颜色主题或隐藏不需要的分量。\n使用 “Amplitude Scale” 调整波形振幅显示范围。\n\n\n信号处理：\n在 “Signal Processing” 面板中，勾选 “Demean” 去除基线漂移。\n选择 “Bandpass”，设置频率为 0.1 - 5.0 Hz，点击 “Apply” 以滤除噪声。\n\n\n设置预警：\n在 “Event Trigger” 面板设置 ON=4.0, OFF=1.5。\n点击 “Set Trigger”。当地震发生时，系统将自动画红线并报警。\n\n\n\n","tags":["SeisMonitor","地震学","信号监测"]}]